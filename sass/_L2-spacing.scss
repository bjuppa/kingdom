$vertical-space-base: 1em !default;
$desired-body-font-size: 18px !default;
$body-line-height-factor: 1.5 !default;
$min-line-height-factor: 1.2 !default;
$modular-scale: 1.2 !default;
$font-size-smaller: 100%/$modular-scale !default;

@import "modules/converters";

$font-sizes: font-size-rem($desired-body-font-size) !default;
@while (length($font-sizes) < 6) {
  $font-sizes: append($font-sizes, nth($font-sizes, length($font-sizes)) * $modular-scale);
}

$line-heights: $body-line-height-factor !default;
@while (length($line-heights) < 6) {
  $line-heights: append($line-heights, (length($line-heights) + 1) * ($min-line-height-factor - $body-line-height-factor) / 5 + (6 * $body-line-height-factor - $min-line-height-factor) / 5);
}

@import "L1-reset";

/* Kingdom CSS Level 2 - Vertical Spacing & Sizing */

* {
  margin: 0;
}

* + * {
  /* Set default vertical spacing between all adjacent block level elements */
  margin-top: $vertical-space-base;
}

.kingdom-spacing-reset {
  /* Reset vertical spacing */
  margin-top: 0;
}

.kingdom-spacing-reset-children > * {
  @extend .kingdom-spacing-reset;
}

.kingdom-spacing-reset-within * {
  @extend .kingdom-spacing-reset;
}

.kingdom-spacing-reset-after + * {
  @extend .kingdom-spacing-reset;
}

dt, li, hgroup, h1, h2, h3, h4, h5, h6 {
  // Reset vertical spacing on adjacent siblings
  + * {
    @extend .kingdom-spacing-reset;
  }
}

script, template, map, [type="hidden"], [hidden] {
  // Reset vertical spacing on element's adjacent siblings, and if last among its siblings on the element itself
  // Effect is correct spacing around "hidden" or empty elements
  + *, &:last-child {
    @extend .kingdom-spacing-reset;
  }
}

textarea, select, input:not([type="button"]):not([type="reset"]):not([type="submit"]) {
  // Reset vertical spacing on non-button form elements when preceded by label
  label + & {
    @extend .kingdom-spacing-reset;
  }
}

figure, picture, object, select, table, audio, video, map {
  // Reset all vertical spacing deep inside
  * {
    @extend .kingdom-spacing-reset;
  }
}

@import "modules/text";

// Helpers for text sizing

@for $i from 1 through 6 {
  .text-#{$i} {
    @include set-text(nth($font-sizes, $i), nth($line-heights, $i));
  }
}

.text-inherit {
  @include set-text(inherit, inherit);
}

.text-small {
  font-size: font-size-em($font-size-smaller);
}

.text-x-small {
  $font-size-smaller: font-size-em($font-size-smaller);
  font-size: $font-size-smaller*strip-unit($font-size-smaller);
}

.text-body {
  @extend .text-1;
}

// Apply text properties to elements...

body {
  @extend .text-body;
}

* {
  @extend .text-inherit;
}

small {
  @extend .text-small;
}

sub, sup {
  @extend .text-x-small;
}

h1 {
  @extend .text-4;
}

h2 {
  @extend .text-3;
}

h3 {
  @extend .text-2;
}

h4 {
  @extend .text-1;
}

h5 {
  @extend .text-small;
}

h6 {
  @extend .text-x-small;
}
